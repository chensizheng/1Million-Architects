架构第一性原理：降本增效

###技术人员发展之道:架构师认知进化

人和人之间最大的差异是认知差异，认知决定一切！

- 达克定律

![image-20190605201350663](/Users/chen/Library/Application Support/typora-user-images/image-20190605201350663.png)

衡量一个人成功的标准，不是看这个人站在巅峰，而是

人生总有起落，精神终可传承。

SomeBody：把简单问题复杂化，把复杂问题搞不定！

### 架构格局

提高架构认知高度，仅寄希望于代码层级是远远不够的

代码解决执行力的问题，架构认知更多依赖战略（业务洞察力）和战术问题(技术视野)，即架构格局

### 架构是什么

对业务场景抽象后得出的支撑框架;

架构为业务而生，被业务场景所弃(业务场景提升，架构提升变化)；

架构没有最好，只有"最合适"

- 技术研发力、业务复杂度、规模大小、时间成本、运维能力；

"最合适"的架构都是各方面折中（Balance）的结果；

场景驱动架构不断演进；

### 架构的演进

单体 -> 水平分层、SOA面向服务  -> MicroService  -> Service Mesh

### 破局

数据库存储量大、请求量大破局

- 水平拆分(分表)
- 垂直拆分(分库)

架构拆分同理

- 垂直方向(业务)

- 水平方向(功能)

  

### 面向服务的架构 SOA

垂直拆分

- 电商案例

缺点：仅垂直拆分，每个服务还是一个单体

### 水平分层架构

一个请求进来，按照什么规则拆分

- 电商案例

  网关层、业务逻辑层、数据访问层

分层设计原则：

服务展示、网关服务、逻辑服务、数据服务：都是分离的

- 网关层功能

  请求鉴权(发布商品、登录鉴权)

  数据完整性检查(数据包定长Header+变长Body)

  协议转换(Json -> hashMap<Stirng,Object>)

  路由转发(根据CMD转发到不同业务逻辑层)

  服务治理(限流、降级、熔断等)

- 水平架构服务和协议

  网关层：

  ​	web服务；SpringBoot

  ​	HTTPS；JOSN

  业务逻辑层：

  ​	RPC服务；Dubbo

  ​	TPC；二进制

  数据访问层：

  ​	RPC服务；Dubbo

  ​	TCP；二进制

同步架构OR异步架构



### 微服务架构

- 电商案例

业务垂直拆分+功能水平拆



需求层面：需求变更小，没必要微服务

性能层面：性能要求(RT)极高，不要用微服务

数据一致性层面：微服务一般是最终一致性  ，强一致性的没必要微服务

### 微服务架构不是银弹

业务关注服务间通信(基础设施组件)，业务迭代速度变慢

基础设施组件升级困难，影响基础设施团队的交付能力和交付速度

多编程语言之间"通信"问题，每种语言一套基础设施，成本大

破局：

- 基础组件和业务功能耦合在一起，剥离基础组件

业务团队专注于业务逻辑本身

服务通信组件交给基础设施研发团队

。。。。。

TODO 。。。

###Service Mesh

201609公开，2017进入国内

基础设施层，用于处理服务间通信。

实现请求的可靠传递。

轻量级网络代理，与应用程序部署在一起，对应用程序透明。(sidecar)



独立进程、独立升级

业务团队专注于业务逻辑开发

基础设施支持多语言

业务团队和基础设施团队解耦

服务治理和服务本身物理剥离

### 大中台&小前台

转转微服务1.0

![image-20190605233742986](/Users/chen/Library/Application Support/typora-user-images/image-20190605233742986.png)

频繁改动的是：业务逻辑层

业务逻辑层只有一个进程，迭代效率低。破局：拆。



转转微服务2.0

![image-20190605234203576](/Users/chen/Library/Application Support/typora-user-images/image-20190605234203576.png)

问题：公共服务组件化(引用用户jar)，升级困难；

破局：公共组件下沉为服务，提供兼容接口，水平方向拆；



转转微服务3.0

![image-20190605234435277](/Users/chen/Library/Application Support/typora-user-images/image-20190605234435277.png)

- 抽象成公共逻辑层

  

Service Mesh



大中台小前台

![image-20190605235929404](/Users/chen/Library/Application Support/typora-user-images/image-20190605235929404.png)



