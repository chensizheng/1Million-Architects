# 1、互联网架构中的安全规范

## 安全风险点

敏感数据本身

APP客户端安全

外接攻击安全

内部安全

## 安全分类

- 数据安全
  - 用户密码、注册手机号、交易收货信息
- 微服务本身安全
  - 鉴权、限流
- 验证码
  - 注册、登录、确认收货
- 劫持处理
  - DNS劫持、流量劫持、链路劫持
- 外部攻击安全
- 内部安全
- 客户端安全
- 分布式安全平台建设

# 2、互联网架构中数据(存储、传输、展示等)安全设计与实践

## 敏感数据安全

### 数据存储

- 敏感数据脱敏后存储
  - 数据加密：手机号、收货地址，加密后还要能够还原
    - AES(收货地址) 对称加密
    - RC4(手机号)
      - 等长、数据库不用修改、加密速度提升(相比AES)、安全性没有AES高
    - 秘钥存储
      - 秘钥存储在专属秘钥进程内，通过启动配置前缀生成固定秘钥才在专属加密进程内(C++实现)
      - 秘钥存储服务从配置文件中读取一个salt,然后跟程序中的秘钥做运算，生成秘钥，加解密程序拿到秘钥后再做一次运算，生成真正的秘钥。
      - 服务调用方使用专属SDK进行通信获取，获取后存储调用方内存
      - 使用JNI调用C++程序完成加解密
      - 高可用考虑，加密进程多机房部署，调用服务存储秘钥到本地内存
      - 异常情况多机房挂掉，秘钥需要存储在单片机固件中
  - 不可逆加密：登录密码
    - MD5
    - MD5+盐
      - 固定的盐
      - 可变的盐

### 数据传输

- APP -> 服务网关
  - 基于SSL传输加密
  - 基于HTTPS传输加密  ⭐️
- 进入服务网关层
  - 加密传输意义不大
    - 明文传输
  - 内鬼问题
    - 做大的安全隐患
    - 安全红线文件
    - 流程规范

### 数据展示

- 脱敏后显示
- 防止直接抓取

### 数据篡改

- 数字签名



# 3、互联网架构中服务本身安全设计与实践

- 请求鉴权
  - 粗粒度：请求IP节点白名单
  - 细粒度：接口Token鉴权
- 请求容量限制
  - 请求次数：QPS、每天总次数



# 4、互联网架构中劫持安全(DNS、流量、链路）设计

